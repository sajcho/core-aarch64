# Description:	Basic networking utilities
# URL:		https://github.com/iputils/iputils
# Maintainer:	sajcho, saux dot aarch64 at gmail dot com
# Depends on:	libcap libidn2 meson openssl3

name=iputils
version=20211215
release=1
source=(https://github.com/iputils/iputils/archive/${version}/${name}-${version}.tar.gz)

build() {
	cd ${name}-${version}

	build-meson \
		-DUSE_IDN=true \
		-DBUILD_RARPD=true \
		-DSKIP_TESTS=true \
		-DUSE_GETTEXT=false \
		-DBUILD_MANS=false \
		. build

	meson compile ${JOBS:+-j ${JOBS}} -v -C build

	install -d $PKG/{{sbin,bin},usr/{bin,sbin,share/man/man8}}
	install build/ping/ping $PKG/bin/
	install build/arping $PKG/sbin/
	install build/{tracepath,clockdiff,rdisc,rarpd} $PKG/usr/sbin/
	install build/ninfod/ninfod $PKG/usr/sbin/

	chmod u+s $PKG/bin/ping
}
